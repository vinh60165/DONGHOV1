{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import'./FormPage.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function FormPage(){const[formData,setFormData]=useState({name:'',email:'',image:''});const[users,setUsers]=useState([]);const[editingId,setEditingId]=useState(null);// Thêm state để biết đang sửa ai\nconst[image,setFile]=useState(null);const fetchUsers=async()=>{try{const response=await axios.get('http://localhost:3002/product/gets');setUsers(response.data);}catch(error){console.error('Error fetching users:',error);}};useEffect(()=>{fetchUsers();},[]);const handleChange=e=>{setFormData({...formData,[e.target.name]:e.target.value});};const handleFileChange=e=>{console.log(e.target.files);setFile(e.target.files[0]);};const handleSubmit=async e=>{e.preventDefault();const data=new FormData();data.append(\"name\",formData.name);data.append(\"email\",formData.email);data.append(\"image\",image);console.log(image);console.log(editingId);console.log(formData);/*  *//*  */if(editingId){// Nếu đang sửa thì gọi PUT API\ntry{await axios.put(`http://localhost:3002/product/update/${editingId}`,data);setEditingId(null);// reset trạng thái sửa\nsetFormData({name:'',email:'',image:''});fetchUsers();}catch(error){console.error('Error updating user:',error);}}else{// Nếu không thì gọi POST API để thêm mới\ntry{await axios.post('http://localhost:3002/product/add',data);setFormData({name:'',email:'',image:''});fetchUsers();}catch(error){console.error('Error adding user:',error);}}};const handleEdit=user=>{setFormData({name:user.name,email:user.email,image:user.image});setEditingId(user.id);// Ghi nhớ đang sửa ai\n};const handleDelete=async id=>{try{await axios.delete(`http://localhost:3002/product/delete/${id}`);fetchUsers();// Load lại danh sách sau khi xóa\n}catch(error){console.error('Error deleting user:',error);}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:editingId?'Sửa sản phẩm':'Thêm sản phẩm'}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"name\",placeholder:\"T\\xEAn s\\u1EA3n ph\\u1EA9m\",value:formData.name,onChange:handleChange,required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",placeholder:\"Email\",value:formData.email,onChange:handleChange,required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"image\",placeholder:\"file\",onChange:handleFileChange}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:editingId?'Cập nhật':'Thêm sản phẩm'}),editingId&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setEditingId(null);setFormData({name:'',email:'',image:''});},children:\"H\\u1EE7y s\\u1EEDa\"})]}),/*#__PURE__*/_jsx(\"h2\",{children:\"Danh s\\xE1ch s\\u1EA3n ph\\u1EA9m\"}),/*#__PURE__*/_jsxs(\"table\",{border:\"1\",cellPadding:\"10\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Image\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:users.map(user=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:user.id}),/*#__PURE__*/_jsx(\"td\",{children:user.name}),/*#__PURE__*/_jsx(\"td\",{children:user.email}),/*#__PURE__*/_jsx(\"td\",{children:user.image?/*#__PURE__*/_jsx(\"img\",{src:`http://localhost:3002/${user.image}`,alt:user.name,width:\"100\"}):/*#__PURE__*/_jsx(\"img\",{src:\"path/to/default-image.jpg\",alt:\"Default\",width:\"100\"})}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleEdit(user),children:\"S\\u1EEDa\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(user.id),children:\"X\\xF3a\"})]})]},user.id))})]})]});}export default FormPage;","map":{"version":3,"names":["React","useState","useEffect","axios","jsx","_jsx","jsxs","_jsxs","FormPage","formData","setFormData","name","email","image","users","setUsers","editingId","setEditingId","setFile","fetchUsers","response","get","data","error","console","handleChange","e","target","value","handleFileChange","log","files","handleSubmit","preventDefault","FormData","append","put","post","handleEdit","user","id","handleDelete","delete","children","onSubmit","type","placeholder","onChange","required","onClick","border","cellPadding","map","src","alt","width"],"sources":["C:/Users/Vinh-PC/Desktop/QLDONGHO/app/src/page/FormPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport './FormPage.css'; \r\n\r\n\r\nfunction FormPage() {\r\n  const [formData, setFormData] = useState({ name: '', email: '', image: '' });\r\n  const [users, setUsers] = useState([]);\r\n  const [editingId, setEditingId] = useState(null);  // Thêm state để biết đang sửa ai\r\n  const [image, setFile] = useState(null)\r\n\r\n\r\n\r\n\r\n  const fetchUsers = async () => {\r\n    try {\r\n      const response = await axios.get('http://localhost:3002/product/gets');\r\n      setUsers(response.data);\r\n    } catch (error) {\r\n      console.error('Error fetching users:', error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchUsers();\r\n  }, []);\r\n\r\n  const handleChange = (e) => {\r\n    setFormData({ ...formData, [e.target.name]: e.target.value });\r\n  };\r\n\r\n  const handleFileChange = (e) => {\r\n    console.log(e.target.files)\r\n    setFile(e.target.files[0]);\r\n  };\r\n\r\n\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    const data = new FormData();\r\n    data.append(\"name\", formData.name);\r\n    data.append(\"email\", formData.email);\r\n    data.append(\"image\", image);\r\n    console.log(image);\r\n    console.log(editingId)\r\n    console.log(formData)\r\n\r\n\r\n\r\n   /*  */\r\n\r\n\r\n/*  */\r\n    if (editingId) {\r\n      // Nếu đang sửa thì gọi PUT API\r\n      try {\r\n        await axios.put(`http://localhost:3002/product/update/${editingId}`, data);\r\n        \r\n        setEditingId(null); // reset trạng thái sửa\r\n        setFormData({ name: '', email: '', image: '' });\r\n        fetchUsers();\r\n      } catch (error) {\r\n        console.error('Error updating user:', error);\r\n      }\r\n    } else {\r\n      // Nếu không thì gọi POST API để thêm mới\r\n      try {\r\n        await axios.post('http://localhost:3002/product/add', data);\r\n       \r\n        setFormData({ name: '', email: '', image: '' });\r\n        fetchUsers();\r\n      } catch (error) {\r\n        console.error('Error adding user:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleEdit = (user) => {\r\n    setFormData({ name: user.name, email: user.email, image: user.image });\r\n    setEditingId(user.id); // Ghi nhớ đang sửa ai\r\n  };\r\n\r\n  const handleDelete = async (id) => {\r\n  try {\r\n    await axios.delete(`http://localhost:3002/product/delete/${id}`);\r\n    fetchUsers();  // Load lại danh sách sau khi xóa\r\n  } catch (error) {\r\n    console.error('Error deleting user:', error);\r\n  }\r\n};\r\n\r\n\r\n   return (\r\n     <div>\r\n      <h2>{editingId ? 'Sửa sản phẩm' : 'Thêm sản phẩm'}</h2>\r\n      <form onSubmit={handleSubmit}>\r\n         <input\r\n           type=\"text\"\r\n          name=\"name\"\r\n         placeholder=\"Tên sản phẩm\"\r\n         value={formData.name}\r\n         onChange={handleChange}\r\n          required\r\n        />\r\n        <input\r\n          type=\"email\"\r\n          name=\"email\"\r\n          placeholder=\"Email\"\r\n          value={formData.email}\r\n          onChange={handleChange}\r\n           required\r\n        />\r\n            <input\r\n           type=\"file\"\r\n         name=\"image\"\r\n         placeholder=\"file\"\r\n         onChange={handleFileChange}\r\n         \r\n       />   \r\n   \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n \r\n\r\n\r\n        <button type=\"submit\">{editingId ? 'Cập nhật' : 'Thêm sản phẩm'}</button>\r\n        {editingId && (\r\n          <button type=\"button\" onClick={() => {\r\n            setEditingId(null);\r\n            setFormData({ name: '', email: '', image: '' });\r\n          }}>Hủy sửa</button>\r\n        )}\r\n      </form>\r\n\r\n      <h2>Danh sách sản phẩm</h2>\r\n      <table border=\"1\" cellPadding=\"10\" >\r\n        <thead>\r\n          <tr>\r\n            <th>ID</th>\r\n            <th>Name</th>\r\n            <th>Email</th>\r\n            <th>Image</th>\r\n            <th>Actions</th>\r\n          </tr>\r\n        </thead>\r\n      <tbody>\r\n  {users.map((user) => (\r\n    <tr key={user.id}>\r\n      <td>{user.id}</td>\r\n      <td>{user.name}</td>\r\n      <td>{user.email}</td>\r\n\r\n      <td>\r\n        {/* Kiểm tra nếu có ảnh */}\r\n        {user.image ? (\r\n          <img src={`http://localhost:3002/${user.image}`} alt={user.name} width=\"100\" />\r\n        ) : (\r\n          <img src=\"path/to/default-image.jpg\" alt=\"Default\" width=\"100\" />\r\n        )}\r\n      </td>\r\n      <td>\r\n        <button onClick={() => handleEdit(user)}>Sửa</button>\r\n        <button onClick={() => handleDelete(user.id)}>Xóa</button>\r\n      </td>\r\n    </tr>\r\n  ))}\r\n</tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default FormPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}